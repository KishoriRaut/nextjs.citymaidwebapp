<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post a Job - City Maid Services</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        poppins: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            primary: '#4F46E5',
                            secondary: '#4338CA',
                            light: '#EEF2FF',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="font-poppins bg-gray-50" onload="initPage()">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20">
                <div class="flex items-center">
                    <a href="../index.html" class="text-3xl font-bold text-brand-primary tracking-tight">City<span class="text-brand-secondary"> Maid Services</span></a>
                </div>
                <!-- Desktop menu -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="../index.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Home</a>
                    <a href="../jobs/find-maids.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Maids</a>
                    <a href="post-job.html" class="text-brand-primary font-semibold">Post a Job</a>
                    <div class="relative">
                        <button id="userMenuBtn" class="flex items-center space-x-2 text-gray-700 hover:text-brand-primary focus:outline-none">
                            <i class="fas fa-user-circle text-2xl"></i>
                            <span class="font-medium">My Account</span>
                        </button>
                        <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50 border border-gray-200">
                            <a href="dashboard.html" class="block px-4 py-2 hover:bg-gray-100">Dashboard</a>
                            <a href="profile.html" class="block px-4 py-2 hover:bg-gray-100">Profile</a>
                            <a href="#" id="signOutBtn" class="block px-4 py-2 hover:bg-gray-100">Sign Out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Job Posting Form -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h1 class="text-2xl font-bold text-gray-900 mb-6">Post a Job</h1>
            
            <form id="postJobForm" class="space-y-6">
                <!-- Job Basic Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="jobTitle" class="block text-sm font-medium text-gray-700">Job Title *</label>
                        <select id="jobTitle" name="jobTitle" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Job Title</option>
                            <option value="Regular House Cleaning">Regular House Cleaning</option>
                            <option value="Childcare and Light Cleaning">Childcare and Light Cleaning</option>
                            <option value="Elderly Care and Housekeeping">Elderly Care and Housekeeping</option>
                            <option value="Full House Cleaning">Full House Cleaning</option>
                            <option value="Cook and Housekeeper">Cook and Housekeeper</option>
                            <option value="Live-in Domestic Helper">Live-in Domestic Helper</option>
                            <option value="Office Cleaning">Office Cleaning</option>
                            <option value="Post-Construction Cleaning">Post-Construction Cleaning</option>
                            <option value="Weekend Housekeeper">Weekend Housekeeper</option>
                            <option value="Laundry and Ironing">Laundry and Ironing</option>
                            <option value="Baby Caretaker">Baby Caretaker</option>
                            <option value="Pet Care and Housekeeping">Pet Care and Housekeeping</option>
                            <option value="Sutkeri Helper">Sutkeri Helper</option>
                            <option value="Special Event Cleaning">Special Event Cleaning</option>
                            <option value="Patient/Sick Care">Patient/Sick Care</option>
                            <option value="Other">Other (Specify in Description)</option>
                        </select>
                    </div>
                    <div>
                        <label for="jobType" class="block text-sm font-medium text-gray-700">Job Type *</label>
                        <select id="jobType" name="jobType" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Job Type</option>
                            <option value="Regular">Regular</option>
                            <option value="Full-time">Full-time</option>
                            <option value="Part-time">Part-time</option>
                            <option value="One-time">One-time</option>
                            <option value="Weekly">Weekly</option>
                            <option value="Monthly">Monthly</option>
                            <option value="Live-in">Live-in</option>
                        </select>
                    </div>
                    <div>
                        <label for="location" class="block text-sm font-medium text-gray-700">Location *</label>
                        <select id="location" name="location" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Location</option>
                            <option value="Kathmandu">Kathmandu</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Bhaktapur">Bhaktapur</option>
                            <option value="Pokhara">Pokhara</option>
                            <option value="Biratnagar">Biratnagar</option>
                            <option value="Birgunj">Birgunj</option>
                            <option value="Dharan">Dharan</option>
                            <option value="Itahari">Itahari</option>
                            <option value="Hetauda">Hetauda</option>
                            <option value="Butwal">Butwal</option>
                            <option value="Nepalgunj">Nepalgunj</option>
                            <option value="Dhangadhi">Dhangadhi</option>
                            <option value="Other">Other (Specify in Description)</option>
                        </select>
                    </div>
                    <div>
                        <label for="monthlySalary" class="block text-sm font-medium text-gray-700">Monthly Salary (NPR) *</label>
                        <select id="monthlySalary" name="monthlySalary" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Monthly Salary</option>
                            <option value="6000">NPR 6,000</option>
                            <option value="8000">NPR 8,000</option>
                            <option value="10000">NPR 10,000</option>
                            <option value="12000">NPR 12,000</option>
                            <option value="15000">NPR 15,000</option>
                            <option value="18000">NPR 18,000</option>
                            <option value="20000">NPR 20,000</option>
                            <option value="25000">NPR 25,000</option>
                            <option value="30000">NPR 30,000</option>
                        </select>
                    </div>
                    <div>
                        <label for="startDate" class="block text-sm font-medium text-gray-700">Work Start Date *</label>
                        <input type="date" id="startDate" name="startDate" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                    </div>
                    <div>
                        <label for="accommodation" class="block text-sm font-medium text-gray-700">Accommodation Provided *</label>
                        <select id="accommodation" name="accommodation" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Option</option>
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    <div>
                        <label for="foodProvided" class="block text-sm font-medium text-gray-700">Food Provided *</label>
                        <select id="foodProvided" name="foodProvided" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Option</option>
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    <div>
                        <label for="transportation" class="block text-sm font-medium text-gray-700">Transportation Provided *</label>
                        <select id="transportation" name="transportation" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Option</option>
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                </div>

                <!-- Specific Address (Hidden by default) -->
                <div class="mt-4">
                    <div class="flex items-center mb-2">
                        <input id="showAddressToggle" type="checkbox" class="rounded text-brand-primary focus:ring-brand-primary">
                        <label for="showAddressToggle" class="ml-2 text-sm font-medium text-gray-700">Add specific address details (will be shared only with selected applicants)</label>
                    </div>
                    <div id="addressFields" class="grid grid-cols-1 md:grid-cols-2 gap-6 hidden mt-4">
                        <div>
                            <label for="area" class="block text-sm font-medium text-gray-700">Area/Neighborhood</label>
                            <select id="area" name="area"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Area</option>
                                <!-- Kathmandu Areas -->
                                <optgroup label="Kathmandu">
                                    <option value="Thamel">Thamel</option>
                                    <option value="Baluwatar">Baluwatar</option>
                                    <option value="Lazimpat">Lazimpat</option>
                                    <option value="Durbar Marg">Durbar Marg</option>
                                    <option value="Baneshwor">Baneshwor</option>
                                    <option value="Kalanki">Kalanki</option>
                                    <option value="Chabahil">Chabahil</option>
                                    <option value="Samakhusi">Samakhusi</option>
                                    <option value="Budhanilkantha">Budhanilkantha</option>
                                </optgroup>
                                <!-- Lalitpur Areas -->
                                <optgroup label="Lalitpur">
                                    <option value="Jhamsikhel">Jhamsikhel</option>
                                    <option value="Sanepa">Sanepa</option>
                                    <option value="Kupondole">Kupondole</option>
                                    <option value="Jawalakhel">Jawalakhel</option>
                                    <option value="Pulchowk">Pulchowk</option>
                                    <option value="Mangal Bazaar">Mangal Bazaar</option>
                                </optgroup>
                                <!-- Bhaktapur Areas -->
                                <optgroup label="Bhaktapur">
                                    <option value="Suryabinayak">Suryabinayak</option>
                                    <option value="Durbar Square">Durbar Square</option>
                                    <option value="Katunje">Katunje</option>
                                    <option value="Lokanthali">Lokanthali</option>
                                </optgroup>
                                <option value="Other">Other (Specify Below)</option>
                            </select>
                        </div>
                        <div>
                            <label for="landmark" class="block text-sm font-medium text-gray-700">Landmark</label>
                            <select id="landmark" name="landmark"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Landmark Type</option>
                                <option value="Near School">Near School</option>
                                <option value="Near Hospital">Near Hospital</option>
                                <option value="Near Mall">Near Mall</option>
                                <option value="Near Temple">Near Temple</option>
                                <option value="Near Market">Near Market</option>
                                <option value="Near Hotel">Near Hotel</option>
                                <option value="Near Restaurant">Near Restaurant</option>
                                <option value="Near Bus Stop">Near Bus Stop</option>
                                <option value="Near Police Station">Near Police Station</option>
                                <option value="Other">Other (Specify Below)</option>
                            </select>
                        </div>
                        <div class="col-span-2">
                            <label for="addressNotes" class="block text-sm font-medium text-gray-700">Additional Address Notes</label>
                            <textarea id="addressNotes" name="addressNotes" rows="2"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary"
                                placeholder="Only if needed (e.g., building name, street name, specific directions)"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Job Description Template -->
                <div class="space-y-4">
                    <label for="descriptionTemplate" class="block text-sm font-medium text-gray-700">Job Description Template *</label>
                    <select id="descriptionTemplate" name="descriptionTemplate" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        <option value="">Select a Description Template</option>
                        <option value="regular-cleaning">Regular House Cleaning</option>
                        <option value="childcare">Childcare and Light Cleaning</option>
                        <option value="cooking">Cooking and Meal Preparation</option>
                        <option value="elderly-care">Elderly Care</option>
                        <option value="live-in">Live-in Maid</option>
                        <option value="office-cleaning">Office Cleaning</option>
                        <option value="patient-care">Patient/Sick Care</option>
                        <option value="custom">Custom Description</option>
                    </select>
                    
                    <textarea id="description" name="description" rows="4" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary"
                        placeholder="Job description will be generated based on your selection above. You can edit or customize it as needed."></textarea>
                </div>

                <!-- Household Information -->
                <div class="space-y-4">
                    <h2 class="text-lg font-semibold text-gray-900">Household Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="householdSize" class="block text-sm font-medium text-gray-700">Household Size</label>
                            <select id="householdSize" name="householdSize"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Household Size</option>
                                <option value="1-2">1-2 people</option>
                                <option value="3-4">3-4 people</option>
                                <option value="5-6">5-6 people</option>
                                <option value="7+">7+ people</option>
                            </select>
                        </div>
                        <div>
                            <label for="houseType" class="block text-sm font-medium text-gray-700">Type of Residence</label>
                            <select id="houseType" name="houseType"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Residence Type</option>
                                <option value="Apartment">Apartment</option>
                                <option value="House">House</option>
                                <option value="Villa">Villa</option>
                                <option value="Office">Office Space</option>
                            </select>
                        </div>
                        <div>
                            <label for="houseSize" class="block text-sm font-medium text-gray-700">Size of Space</label>
                            <select id="houseSize" name="houseSize"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Approximate Size</option>
                                <option value="Small">Small (1-2 rooms)</option>
                                <option value="Medium">Medium (3-4 rooms)</option>
                                <option value="Large">Large (5+ rooms)</option>
                            </select>
                        </div>
                        <div>
                            <label for="hasPets" class="block text-sm font-medium text-gray-700">Pets in Household</label>
                            <select id="hasPets" name="hasPets"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="No">No Pets</option>
                                <option value="Dogs">Dogs</option>
                                <option value="Cats">Cats</option>
                                <option value="Both">Both Dogs and Cats</option>
                                <option value="Other">Other Pets</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Required Skills -->
                <div class="space-y-4">
                    <label class="block text-sm font-medium text-gray-700">Required Skills * (Select all that apply)</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Cooking" name="skills">
                            <span>Cooking</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Cleaning" name="skills">
                            <span>Cleaning</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Laundry" name="skills">
                            <span>Laundry</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Child Care" name="skills">
                            <span>Child Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Elderly Care" name="skills">
                            <span>Elderly Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Patient Care" name="skills">
                            <span>Patient Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Pet Care" name="skills">
                            <span>Pet Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Postnatal/Sutkeri Care" name="skills">
                            <span>Postnatal/Sutkeri Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Office Assistant" name="skills">
                            <span>Office Assistant</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Gardening" name="skills">
                            <span>Gardening</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Driving" name="skills">
                            <span>Driving</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Ironing" name="skills">
                            <span>Ironing</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Dishwashing" name="skills">
                            <span>Dishwashing</span>
                        </label>
                    </div>
                </div>

                <!-- Experience and Schedule -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="minExperience" class="block text-sm font-medium text-gray-700">Minimum Experience (Years)</label>
                        <select id="minExperience" name="minExperience"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="0">No experience required</option>
                            <option value="1">1+ year</option>
                            <option value="2">2+ years</option>
                            <option value="3">3+ years</option>
                            <option value="5">5+ years</option>
                            <option value="10">10+ years</option>
                        </select>
                    </div>
                    <div>
                        <label for="workingDays" class="block text-sm font-medium text-gray-700">Working Days</label>
                        <select id="workingDays" name="workingDays"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Working Days</option>
                            <option value="Mon-Fri">Sunday to Friday</option>
                            <option value="Weekends">Weekends Only</option>
                            <option value="Flexible">Flexible Schedule</option>
                            <option value="Alternate">Alternate Days</option>
                            <option value="Daily">Daily</option>
                            <option value="Mon">Mondays Only</option>
                            <option value="Tue">Tuesdays Only</option>
                            <option value="Wed">Wednesdays Only</option>
                            <option value="Thu">Thursdays Only</option>
                            <option value="Fri">Fridays Only</option>
                            <option value="Sat">Saturdays Only</option>
                            <option value="Sun">Sundays Only</option>
                        </select>
                    </div>
                    <div>
                        <label for="workingHours" class="block text-sm font-medium text-gray-700">Working Hours</label>
                        <select id="workingHours" name="workingHours"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Working Hours</option>
                            <option value="Morning">Morning (6AM-12PM)</option>
                            <option value="Afternoon">Afternoon (12PM-6PM)</option>
                            <option value="Evening">Evening (6PM-10PM)</option>
                            <option value="Full Day">Full Day (8AM-5PM)</option>
                            <option value="6-2">6:00 AM - 2:00 PM</option>
                            <option value="7-3">7:00 AM - 3:00 PM</option>
                            <option value="8-4">8:00 AM - 4:00 PM</option>
                            <option value="9-5">9:00 AM - 5:00 PM</option>
                            <option value="10-6">10:00 AM - 6:00 PM</option>
                            <option value="2-10">2:00 PM - 10:00 PM</option>
                            <option value="Live-in">Live-in (Full Day)</option>
                            <option value="Custom">Custom Hours</option>
                        </select>
                    </div>
                    <div>
                        <label for="customHours" class="block text-sm font-medium text-gray-700">Custom Hours (if applicable)</label>
                        <select id="customHours" name="customHours"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                            <option value="">Select Hours</option>
                            <option value="1 hour daily">1 hour daily</option>
                            <option value="2 hours daily">2 hours daily</option>
                            <option value="3 hours daily">3 hours daily</option>
                            <option value="4 hours daily">4 hours daily</option>
                            <option value="5 hours daily">5 hours daily</option>
                            <option value="6 hours daily">6 hours daily</option>
                            <option value="8 hours daily">8 hours daily</option>
                            <option value="10 hours daily">10 hours daily</option>
                            <option value="2 hours, 3 days a week">2 hours, 3 days a week</option>
                            <option value="3 hours, 2 days a week">3 hours, 2 days a week</option>
                            <option value="4 hours weekly">4 hours weekly</option>
                            <option value="8 hours weekly">8 hours weekly</option>
                            <option value="One-time service">One-time service</option>
                        </select>
                    </div>
                </div>

                <!-- Additional Requirements -->
                <div class="space-y-4">
                    <h2 class="text-lg font-semibold text-gray-900">Additional Requirements</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="language" class="block text-sm font-medium text-gray-700">Language Requirements</label>
                            <select id="language" name="language"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="Nepali">Nepali</option>
                                <option value="English">English</option>
                                <option value="Hindi">Hindi</option>
                                <option value="Newari">Newari</option>
                                <option value="Tamang">Tamang</option>
                                <option value="Gurung">Gurung</option>
                                <option value="Magar">Magar</option>
                                <option value="Tharu">Tharu</option>
                            </select>
                        </div>
                        <div>
                            <label for="agePreference" class="block text-sm font-medium text-gray-700">Age Preference</label>
                            <select id="agePreference" name="agePreference"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="18-25">18-25 years</option>
                                <option value="25-35">25-35 years</option>
                                <option value="35-45">35-45 years</option>
                                <option value="45+">45+ years</option>
                            </select>
                        </div>
                        <div>
                            <label for="religionPreference" class="block text-sm font-medium text-gray-700">Religion Preference</label>
                            <select id="religionPreference" name="religionPreference"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="Hindu">Hindu</option>
                                <option value="Buddhist">Buddhist</option>
                                <option value="Muslim">Muslim</option>
                                <option value="Christian">Christian</option>
                                <option value="Kirat">Kirat</option>
                                <option value="Jain">Jain</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="nationalityPreference" class="block text-sm font-medium text-gray-700">Nationality Preference</label>
                            <select id="nationalityPreference" name="nationalityPreference"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="Nepali">Nepali</option>
                                <option value="Indian">Indian</option>
                                <option value="Bangladeshi">Bangladeshi</option>
                                <option value="Sri Lankan">Sri Lankan</option>
                                <option value="Filipino">Filipino</option>
                                <option value="Indonesian">Indonesian</option>
                                <option value="Bhutanese">Bhutanese</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="genderPreference" class="block text-sm font-medium text-gray-700">Gender Preference</label>
                            <select id="genderPreference" name="genderPreference"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="Female">Female</option>
                                <option value="Male">Male</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="maritalStatusPreference" class="block text-sm font-medium text-gray-700">Marital Status Preference</label>
                            <select id="maritalStatusPreference" name="maritalStatusPreference"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="Single">Single</option>
                                <option value="Married">Married</option>
                                <option value="Divorced">Divorced</option>
                                <option value="Widowed">Widowed</option>
                            </select>
                        </div>
                        <div>
                            <label for="educationLevel" class="block text-sm font-medium text-gray-700">Minimum Education</label>
                            <select id="educationLevel" name="educationLevel"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Education Required</option>
                                <option value="Primary">Primary School</option>
                                <option value="SEE">SEE</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Bachelor">Bachelor's Degree</option>
                            </select>
                        </div>
                        <div>
                            <label for="documentsRequired" class="block text-sm font-medium text-gray-700">Documents Required</label>
                            <select id="documentsRequired" name="documentsRequired"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Required Documents</option>
                                <option value="Citizenship">Citizenship Card Only</option>
                                <option value="Citizenship_Photo">Citizenship Card & Photo ID</option>
                                <option value="All">All Legal Documents (Citizenship, Photo ID, Police Verification)</option>
                                <option value="Passport">Passport for Foreign Nationals</option>
                                <option value="Work_Permit">Work Permit for Foreign Nationals</option>
                                <option value="None">No Documents Required</option>
                            </select>
                        </div>
                        <div>
                            <label for="childrenPreference" class="block text-sm font-medium text-gray-700">Children Preference</label>
                            <select id="childrenPreference" name="childrenPreference"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">No Preference</option>
                                <option value="No Children">No Children</option>
                                <option value="Children Allowed">Children Allowed</option>
                                <option value="Children Preferred">Children Preferred</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="space-y-4">
                    <h2 class="text-lg font-semibold text-gray-900">Additional Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="contractDuration" class="block text-sm font-medium text-gray-700">Contract Duration *</label>
                            <select id="contractDuration" name="contractDuration" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Duration</option>
                                <option value="1 month">1 Month</option>
                                <option value="3 months">3 Months</option>
                                <option value="6 months">6 Months</option>
                                <option value="1 year">1 Year</option>
                                <option value="2 years">2 Years</option>
                                <option value="Open-ended">Open-ended</option>
                            </select>
                        </div>
                        <div>
                            <label for="vacationDays" class="block text-sm font-medium text-gray-700">Vacation Days *</label>
                            <select id="vacationDays" name="vacationDays" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Vacation Days</option>
                                <option value="1 day per month">1 Day per Month</option>
                                <option value="2 days per month">2 Days per Month</option>
                                <option value="4 days per month">4 Days per Month</option>
                                <option value="1 day per week">1 Day per Week</option>
                                <option value="2 days per week">2 Days per Week</option>
                                <option value="As per government rules">As per Government Rules</option>
                            </select>
                        </div>
                        <div>
                            <label for="medicalInsurance" class="block text-sm font-medium text-gray-700">Medical Insurance *</label>
                            <select id="medicalInsurance" name="medicalInsurance" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Option</option>
                                <option value="true">Yes</option>
                                <option value="false">No</option>
                            </select>
                        </div>
                        <div>
                            <label for="otherBenefits" class="block text-sm font-medium text-gray-700">Other Benefits</label>
                            <select id="otherBenefits" name="otherBenefits"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Benefits</option>
                                <option value="Festival Bonus">Festival Bonus</option>
                                <option value="Performance Bonus">Performance Bonus</option>
                                <option value="Provident Fund">Provident Fund</option>
                                <option value="Insurance">Insurance</option>
                                <option value="Training">Training</option>
                                <option value="Education Support">Education Support</option>
                                <option value="Transport Allowance">Transport Allowance</option>
                                <option value="Meal Allowance">Meal Allowance</option>
                                <option value="None">None</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="space-y-6">
                    <h2 class="text-lg font-semibold text-gray-900">Contact Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="contactName" class="block text-sm font-medium text-gray-700">Contact Name *</label>
                            <input type="text" id="contactName" name="contactName" required
                                placeholder="Your name"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="contactPhone" class="block text-sm font-medium text-gray-700">Phone Number *</label>
                            <input type="tel" id="contactPhone" name="contactPhone" required
                                placeholder="Your phone number"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="contactEmail" class="block text-sm font-medium text-gray-700">Email *</label>
                            <input type="email" id="contactEmail" name="contactEmail" required
                                placeholder="Your email address"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="preferredContact" class="block text-sm font-medium text-gray-700">Preferred Contact Method</label>
                            <select id="preferredContact" name="preferredContact"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="Any">Any Method</option>
                                <option value="Phone">Phone</option>
                                <option value="Email">Email</option>
                                <option value="WhatsApp">WhatsApp</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="flex justify-end">
                    <button type="submit"
                        class="bg-brand-primary text-white px-8 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                        Post Job
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://fdgqqxyyofjnkhswkwcq.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZkZ3FxeHl5b2Zqbmtoc3drd2NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQwMjQyMTMsImV4cCI6MjA1OTYwMDIxM30.YyJLLu3r2a7Mh7ny0ie-YzzLfPh5PdrJJHnBFBxWqVE';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
        
        // Session related variables
        let currentUser = null;
        
        // Main initialization function
        function initPage() {
            console.log("Initializing page...");
            
            // Set up description template handler
            setupDescriptionTemplates();
            
            // Set up address toggle
            setupAddressToggle();
            
            // Set up skill checkboxes
            setupSkillCheckboxes();
            
            // Set up job title change handler
            setupJobTitleHandler();
            
            // Authentication check
            // Commented out for testing purposes
            // checkSession();

            // Initialize navigation functionality
            initNavigation();
        }
        
        // Setup description templates functionality
        function setupDescriptionTemplates() {
            console.log("Setting up description templates...");
            const descriptionTemplateSelect = document.getElementById('descriptionTemplate');
            const descriptionTextarea = document.getElementById('description');
            
            if (descriptionTemplateSelect && descriptionTextarea) {
                descriptionTemplateSelect.addEventListener('change', function() {
                    console.log("Template selected:", this.value);
                    const selectedTemplate = this.value;
                    let templateText = '';
                    
                    switch(selectedTemplate) {
                        case 'regular-cleaning':
                            templateText = "Looking for a reliable maid for regular house cleaning. Duties include sweeping, mopping, dusting, bathroom cleaning, and general tidying. The ideal candidate is thorough, detail-oriented, and can work independently. Must have good time management skills and be reliable.";
                            break;
                        case 'childcare':
                            templateText = "Seeking a caring and responsible maid for childcare and light cleaning. Responsibilities include looking after children, preparing meals, helping with homework, light cleaning, and maintaining a safe environment. The ideal candidate is patient, energetic, and experienced with children.";
                            break;
                        case 'cooking':
                            templateText = "Hiring a skilled cook for meal preparation. Duties include planning meals, grocery shopping, cooking daily meals, and keeping the kitchen clean. Must be knowledgeable about Nepali cuisine and able to prepare healthy and varied meals. Food hygiene knowledge is essential.";
                            break;
                        case 'elderly-care':
                            templateText = "Looking for a compassionate caregiver for an elderly family member. Responsibilities include personal care assistance, medication reminders, meal preparation, light housekeeping, and companionship. The ideal candidate is patient, experienced with elderly care, and able to provide emotional support.";
                            break;
                        case 'live-in':
                            templateText = "Seeking a full-time live-in maid for household management. Responsibilities include cleaning, cooking, childcare, laundry, and general household maintenance. Accommodation and meals provided. The ideal candidate is hardworking, trustworthy, and organized with experience in managing a household.";
                            break;
                        case 'office-cleaning':
                            templateText = "Hiring a cleaner for regular office maintenance. Duties include dusting, vacuuming, bathroom cleaning, trash removal, and keeping common areas tidy. Must be reliable, detail-oriented, and able to work efficiently with minimal supervision.";
                            break;
                        case 'patient-care':
                            templateText = "Looking for a compassionate caregiver for a patient or sick family member. Responsibilities include personal care assistance, medication reminders, meal preparation, light housekeeping, and companionship. The ideal candidate is patient, experienced with patient care, and able to provide emotional support.";
                            break;
                        case 'custom':
                            templateText = ""; // Empty for custom description
                            break;
                    }
                    
                    if (templateText) {
                        descriptionTextarea.value = templateText;
                    }
                });
            }
        }
        
        // Setup address toggle functionality
        function setupAddressToggle() {
            console.log("Setting up address toggle...");
            const showAddressToggle = document.getElementById('showAddressToggle');
            const addressFields = document.getElementById('addressFields');
            
            if (showAddressToggle && addressFields) {
                showAddressToggle.addEventListener('change', function() {
                    if (this.checked) {
                        addressFields.classList.remove('hidden');
                    } else {
                        addressFields.classList.add('hidden');
                    }
                });
            }
        }
        
        // Setup skill checkboxes
        function setupSkillCheckboxes() {
            console.log("Setting up skill checkboxes...");
            const skillCheckboxes = document.querySelectorAll('.skill-checkbox');
            
            if (skillCheckboxes.length > 0) {
                skillCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', updateRequirements);
                });
            }
        }
        
        // Setup job title handler
        function setupJobTitleHandler() {
            console.log("Setting up job title handler...");
            const jobTitleSelect = document.getElementById('jobTitle');
            const monthlySalarySelect = document.getElementById('monthlySalary');
            
            if (jobTitleSelect && monthlySalarySelect) {
                jobTitleSelect.addEventListener('change', function() {
                    const selectedJob = this.value;
                    
                    // Set suggested monthly salaries based on job type
                    switch(selectedJob) {
                        case 'Regular House Cleaning':
                        case 'Laundry and Ironing':
                            suggestMonthlySalary('10000');
                            break;
                        case 'Childcare and Light Cleaning':
                        case 'Elderly Care and Housekeeping':
                        case 'Cook and Housekeeper':
                            suggestMonthlySalary('12000');
                            break;
                        case 'Full House Cleaning':
                        case 'Office Cleaning':
                        case 'Baby Caretaker':
                            suggestMonthlySalary('15000');
                            break;
                        case 'Post-Construction Cleaning':
                            suggestMonthlySalary('18000');
                            break;
                        case 'Sutkeri Helper':
                        case 'Pet Care and Housekeeping':
                            suggestMonthlySalary('20000');
                            break;
                        case 'Patient/Sick Care':
                            suggestMonthlySalary('25000');
                            break;
                        case 'Live-in Domestic Helper':
                            suggestMonthlySalary('12000');
                            break;
                    }
                });
            }
        }
        
        // Utility functions
        function showLoading() {
            // Disable submit button and change text
            const submitButton = document.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Posting...';
            }
        }
        
        function hideLoading() {
            // Re-enable submit button
            const submitButton = document.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.disabled = false;
                submitButton.innerHTML = 'Post Job';
            }
        }
        
        function showError(message) {
            // Create error toast with longer duration and copy button
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center space-x-4';
            toast.innerHTML = `
                <div class="flex items-center">
                <i class="fas fa-exclamation-circle mr-2"></i>
                <span>${message}</span>
                </div>
                <button class="copy-error-btn bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-sm">
                    Copy Error
                </button>
            `;
            document.body.appendChild(toast);
            
            // Add click handler for copy button
            const copyBtn = toast.querySelector('.copy-error-btn');
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(message);
                copyBtn.textContent = 'Copied!';
                setTimeout(() => {
                    copyBtn.textContent = 'Copy Error';
                }, 2000);
            });
            
            // Remove after 10 seconds instead of 3
            setTimeout(() => {
                toast.remove();
            }, 10000);
        }
        
        function showSuccess(message) {
            // Create success toast
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center';
            toast.innerHTML = `
                <i class="fas fa-check-circle mr-2"></i>
                <span>${message}</span>
            `;
            document.body.appendChild(toast);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        // Check session and redirect if not logged in
        async function checkSession() {
            try {
            // Get current session
                const { data: { session }, error: sessionError } = await supabaseClient.auth.getSession();
                
                if (sessionError) {
                    console.error('Session error:', sessionError);
                    showError('Error checking your session. Please try logging in again.');
                    return;
                }
                
                if (!session) {
                window.location.href = '../auth/login.html?redirect=employer/post-job.html&type=employer';
                return;
            }
            
                // First try to get the profile
                console.log('Attempting to get profile...');
                let { data: profile, error: profileError } = await supabaseClient
                .from('profiles')
                    .select('role, user_type')
                .eq('id', session.user.id)
                .single();
                
                if (profileError) {
                    console.error('Profile error details:', profileError);
                    
                    // If profile doesn't exist, create it
                    if (profileError.code === 'PGRST116') {
                        console.log('Profile does not exist, creating new profile...');
                        const { data: newProfile, error: createError } = await supabaseClient
                            .from('profiles')
                            .insert([
                                {
                                    id: session.user.id,
                                    role: 'employer',
                                    user_type: 'employer',
                                    full_name: session.user.user_metadata?.full_name || '',
                                    created_at: new Date().toISOString()
                                }
                            ])
                            .select()
                            .single();
                            
                        if (createError) {
                            console.error('Create profile error:', createError);
                            const errorMessage = `Error creating your profile: ${createError.message}\n\nTo fix this, run this SQL in Supabase SQL editor:\n\nINSERT INTO profiles (id, role, full_name, user_type) VALUES ('${session.user.id}', 'employer', '', 'employer');`;
                            showError(errorMessage);
                return;
            }
            
                        console.log('Profile created successfully');
                        profile = newProfile;
                    } else {
                        const errorMessage = `Profile error: ${profileError.message}\n\nTo fix this, run this SQL in Supabase SQL editor:\n\nINSERT INTO profiles (id, role, full_name, user_type) VALUES ('${session.user.id}', 'employer', '', 'employer');`;
                        showError(errorMessage);
                return;
                    }
                }
                
                // Now we can safely check the role
                if (!profile || profile.role !== 'employer' || profile.user_type !== 'employer') {
                    console.log('Updating role to employer...');
                    const { error: updateError } = await supabaseClient
                        .from('profiles')
                        .update({ 
                            role: 'employer',
                            user_type: 'employer'
                        })
                        .eq('id', session.user.id);
                        
                    if (updateError) {
                        console.error('Update role error details:', updateError);
                        const errorMessage = `Role update error: ${updateError.message}\n\nTo fix this, run this SQL in Supabase SQL editor:\n\nUPDATE profiles SET role = 'employer', user_type = 'employer' WHERE id = '${session.user.id}';`;
                        showError(errorMessage);
                        return;
                    }
                    console.log('Role updated to employer');
            }
            
            // Store current user
            currentUser = session.user;
            
            // Update UI to show logged in state
            updateNavigation(profile);
                
            } catch (error) {
                console.error('Unexpected error:', error);
                showError('An unexpected error occurred. Please try again or contact support.');
            }
        }
        
        // Update navigation based on user profile
        function updateNavigation(profile) {
            // Show/hide elements based on authentication status
            document.querySelectorAll('.auth-required').forEach(el => el.classList.remove('hidden'));
            document.querySelectorAll('.auth-not-required').forEach(el => el.classList.add('hidden'));
            
            // Update profile button if it exists
            const profileButton = document.getElementById('profileButton');
            if (profileButton) {
                profileButton.textContent = profile.full_name || 'My Profile';
                profileButton.classList.remove('hidden');
            }
        }

        // Add this test function at the top of your script section
        async function testDatabaseAccess() {
            try {
                const { data, error } = await supabaseClient
                    .from('profiles')
                    .select('count')
                    .limit(1);
                    
                console.log('Database test result:', { data, error });
                return !error;
            } catch (error) {
                console.error('Database test error:', error);
                return false;
            }
        }

        // Handle the post job form submission
        document.getElementById('postJobForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            try {
                showLoading();
                console.log('Starting job post process...');
                
                // Check if user is logged in
                const { data: { session }, error: sessionError } = await supabaseClient.auth.getSession();
                if (sessionError || !session) {
                    console.error('Session error:', sessionError);
                    throw new Error('Please log in to post a job');
                }
                console.log('User session verified:', session.user.id);
                
                // First try to get the profile
                console.log('Attempting to get profile...');
                let { data: profile, error: profileError } = await supabaseClient
                    .from('profiles')
                    .select('role, user_type')
                    .eq('id', session.user.id)
                    .single();
                    
                if (profileError) {
                    console.error('Profile error details:', profileError);
                    
                    // If profile doesn't exist, create it
                    if (profileError.code === 'PGRST116') {
                        console.log('Profile does not exist, creating new profile...');
                        const { data: newProfile, error: createError } = await supabaseClient
                            .from('profiles')
                            .insert([
                                {
                                    id: session.user.id,
                                    role: 'employer',
                                    user_type: 'employer',
                                    full_name: session.user.user_metadata?.full_name || '',
                                    created_at: new Date().toISOString()
                                }
                            ])
                            .select()
                            .single();
                            
                        if (createError) {
                            console.error('Create profile error:', createError);
                            const errorMessage = `Error creating your profile: ${createError.message}\n\nTo fix this, run this SQL in Supabase SQL editor:\n\nINSERT INTO profiles (id, role, full_name, user_type) VALUES ('${session.user.id}', 'employer', '', 'employer');`;
                            showError(errorMessage);
                            return;
                        }
                        
                        console.log('Profile created successfully');
                        profile = newProfile;
                    } else {
                        const errorMessage = `Profile error: ${profileError.message}\n\nTo fix this, run this SQL in Supabase SQL editor:\n\nINSERT INTO profiles (id, role, full_name, user_type) VALUES ('${session.user.id}', 'employer', '', 'employer');`;
                        showError(errorMessage);
                        return;
                    }
                }
                
                // Now we can safely check the role
                if (!profile || profile.role !== 'employer' || profile.user_type !== 'employer') {
                    console.log('Updating role to employer...');
                    const { error: updateError } = await supabaseClient
                        .from('profiles')
                        .update({ 
                            role: 'employer',
                            user_type: 'employer'
                        })
                        .eq('id', session.user.id);
                        
                    if (updateError) {
                        console.error('Update role error details:', updateError);
                        const errorMessage = `Role update error: ${updateError.message}\n\nTo fix this, run this SQL in Supabase SQL editor:\n\nUPDATE profiles SET role = 'employer', user_type = 'employer' WHERE id = '${session.user.id}';`;
                        showError(errorMessage);
                        return;
                    }
                    console.log('Role updated to employer');
                }
                
                // Collect form data
                console.log('Collecting form data...');
                const formData = new FormData(e.target);
                
                // Get selected skills
                const selectedSkills = Array.from(document.querySelectorAll('.skill-checkbox:checked'))
                    .map(checkbox => checkbox.value);
                    
                // Get selected languages
                const selectedLanguages = Array.from(document.querySelectorAll('select[name="language"] option:checked'))
                    .map(option => option.value);
                    
                // Call the create_job function
                console.log('Calling create_job function...');
                const { data, error } = await supabaseClient.rpc('create_job', {
                    p_title: formData.get('jobTitle'),
                    p_job_type: formData.get('jobType'),
                    p_working_location: formData.get('location'),
                    p_monthly_salary: formData.get('monthlySalary'),
                    p_description: formData.get('description'),
                    p_household_size: formData.get('householdSize'),
                    p_house_type: formData.get('houseType'),
                    p_house_size: formData.get('houseSize'),
                    p_has_pets: formData.get('hasPets'),
                    p_required_skills: selectedSkills,
                    p_working_days: formData.get('workingDays'),
                    p_working_hours: formData.get('workingHours'),
                    p_custom_hours: formData.get('customHours'),
                    p_experience_required: formData.get('minExperience'),
                    p_languages: selectedLanguages,
                    p_age_preference: formData.get('agePreference'),
                    p_gender_preference: formData.get('genderPreference'),
                    p_marital_status_preference: formData.get('maritalStatusPreference'),
                    p_nationality_preference: formData.get('nationalityPreference'),
                    p_education_level: formData.get('educationLevel'),
                    p_documents_required: formData.get('documentsRequired'),
                    p_contact_name: formData.get('contactName'),
                    p_contact_phone: formData.get('contactPhone'),
                    p_contact_email: formData.get('contactEmail'),
                    p_start_date: formData.get('startDate'),
                    p_accommodation: formData.get('accommodation'),
                    p_food_provided: formData.get('foodProvided'),
                    p_transportation: formData.get('transportation'),
                    p_children_preference: formData.get('childrenPreference'),
                    p_contract_duration: formData.get('contractDuration'),
                    p_vacation_days: formData.get('vacationDays'),
                    p_medical_insurance: formData.get('medicalInsurance'),
                    p_other_benefits: formData.get('otherBenefits')
                });
                    
                if (error) {
                    console.error('Create job error details:', error);
                    const errorMessage = `Job creation error: ${error.message}\n\nPlease check the browser console (F12) for more details.`;
                    showError(errorMessage);
                    return;
                }
                
                console.log('Job created successfully:', data);
                hideLoading();
                showSuccess('Your job has been posted successfully!');
                
                setTimeout(() => {
                    window.location.href = '../jobs/find-maids.html';
                }, 2000);
                    
            } catch (error) {
                console.error('Error posting job:', error);
                hideLoading();
                const errorMessage = `Unexpected error: ${error.message}\n\nPlease check the browser console (F12) for more details.`;
                showError(errorMessage);
            }
        });

        // Handle sign out
        document.getElementById('signOutBtn').addEventListener('click', async function() {
            try {
                const { error } = await supabaseClient.auth.signOut();
                if (error) throw error;
                window.location.href = '../index.html';
            } catch (error) {
                console.error('Error signing out:', error);
                showError('Error signing out. Please try again.');
            }
        });

        // Update requirements based on selected skills
        function updateRequirements() {
            const skillsSelected = Array.from(document.querySelectorAll('.skill-checkbox:checked'))
                .map(checkbox => checkbox.value);
            
            // Don't auto-generate if user has already typed something
            const requirementsField = document.getElementById('requirements');
            if (requirementsField && requirementsField.value.trim() === '') {
                let suggestedRequirements = '';
                
                if (skillsSelected.includes('Cooking')) {
                    suggestedRequirements += '- Experience in Nepali and international cuisine preferred\n';
                }
                
                if (skillsSelected.includes('Cleaning')) {
                    suggestedRequirements += '- Knowledge of cleaning products and techniques required\n';
                }
                
                if (skillsSelected.includes('Child Care')) {
                    suggestedRequirements += '- Experience with children of different age groups\n';
                }
                
                if (skillsSelected.includes('Elderly Care')) {
                    suggestedRequirements += '- Understanding of elderly needs and patience required\n';
                }
                
                if (skillsSelected.includes('Patient Care')) {
                    suggestedRequirements += '- Experience with patient care and medical assistance knowledge\n';
                }
                
                if (skillsSelected.includes('Pet Care')) {
                    suggestedRequirements += '- Comfortable with pets and basic pet care knowledge\n';
                }
                
                if (skillsSelected.includes('Postnatal/Sutkeri Care')) {
                    suggestedRequirements += '- Experience with newborns and knowledge of postnatal care\n';
                }
                
                if (skillsSelected.includes('Driving')) {
                    suggestedRequirements += '- Valid driving license required\n';
                }
                
                requirementsField.value = suggestedRequirements;
            }
        }
        
        // Suggest monthly salary based on job title
        function suggestMonthlySalary(salary) {
            const monthlySalarySelect = document.getElementById('monthlySalary');
            if (monthlySalarySelect) {
                monthlySalarySelect.value = salary;
            }
        }

        // Initialize navigation functionality
        function initNavigation() {
            // User menu dropdown
            const userMenuBtn = document.getElementById('userMenuBtn');
            const userDropdown = document.getElementById('user-dropdown');
            
            if (userMenuBtn && userDropdown) {
                // Ensure dropdown is hidden by default
                userDropdown.classList.add('hidden');
                
                userMenuBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    userDropdown.classList.toggle('hidden');
                });
                
                // Close dropdown when clicking elsewhere
                document.addEventListener('click', (e) => {
                    if (!userDropdown.contains(e.target) && !userMenuBtn.contains(e.target)) {
                        userDropdown.classList.add('hidden');
                    }
                });
                
                // Close dropdown when clicking on a dropdown item
                userDropdown.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                        userDropdown.classList.add('hidden');
                    });
                });
            }
            
            // Sign out functionality
            const signOutBtn = document.getElementById('signOutBtn');
            if (signOutBtn) {
                signOutBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    try {
                        await supabaseClient.auth.signOut();
                        window.location.href = '../index.html';
                    } catch (error) {
                        console.error('Error signing out:', error);
                        showError('Error signing out. Please try again.');
                    }
                });
            }
        }
    </script>
</body>
</html> 